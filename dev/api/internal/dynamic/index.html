<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Dynamic.jl · ContGridModML</title><meta name="title" content="Dynamic.jl · ContGridModML"/><meta property="og:title" content="Dynamic.jl · ContGridModML"/><meta property="twitter:title" content="Dynamic.jl · ContGridModML"/><meta name="description" content="Documentation for ContGridModML."/><meta property="og:description" content="Documentation for ContGridModML."/><meta property="twitter:description" content="Documentation for ContGridModML."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">ContGridModML</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Introduction</a></li><li><span class="tocitem">Implementation</span><ul><li><a class="tocitem" href="../../../implementation/finite/">Finite Element Method</a></li><li><a class="tocitem" href="../../../implementation/general/">General Implementation</a></li><li><a class="tocitem" href="../../../implementation/static/">Learn Susceptances</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../public/">Public</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox" checked/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Internal</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Dynamic.jl</a><ul class="internal"><li><a class="tocitem" href="#Contents"><span>Contents</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#Functions"><span>Functions</span></a></li></ul></li><li><a class="tocitem" href="../static/">Static.jl</a></li><li><a class="tocitem" href="../tools/">Tools.jl</a></li><li><a class="tocitem" href="../mesh/">Mesh.jl</a></li><li><a class="tocitem" href="../init/">Initl.jl</a></li><li><a class="tocitem" href="../disc_dynamics/">Disc_dynamics.jl</a></li><li><a class="tocitem" href="../cont_dynamics/">Cont_dynamics.jl</a></li><li><a class="tocitem" href="../plot/">Plot.jl</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li><a class="is-disabled">Internal</a></li><li class="is-active"><a href>Dynamic.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Dynamic.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/julianfritzsch/ContGridModML.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/main/docs/src/api/internal/dynamic.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Dynamic.jl"><a class="docs-heading-anchor" href="#Dynamic.jl">Dynamic.jl</a><a id="Dynamic.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Dynamic.jl" title="Permalink"></a></h1><p>Description of internally used functions for the learning of the dynamic parameters.</p><h2 id="Contents"><a class="docs-heading-anchor" href="#Contents">Contents</a><a id="Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Contents" title="Permalink"></a></h2><ul><li><a href="#Contents">Contents</a></li><li><a href="#Index">Index</a></li><li><a href="#Functions">Functions</a></li></ul><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#ContGridModML.assemble_f_dynamic-Tuple{ContGridModML.ContModel, ContGridModML.DiscModel, Vector{&lt;:Integer}, Union{Real, Vector{&lt;:Real}}, SparseArrays.SparseMatrixCSC}"><code>ContGridModML.assemble_f_dynamic</code></a></li><li><a href="#ContGridModML.assemble_matrices_dynamic-Tuple{ContGridModML.ContModel}"><code>ContGridModML.assemble_matrices_dynamic</code></a></li><li><a href="#ContGridModML.cont_dyn-Tuple{SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, Vector{&lt;:Real}, Vector{&lt;:Real}, Real}"><code>ContGridModML.cont_dyn</code></a></li><li><a href="#ContGridModML.disc_dyn-Tuple{ContGridModML.DiscModel, Integer, Real, Real, Real}"><code>ContGridModML.disc_dyn</code></a></li><li><a href="#ContGridModML.gen_idxs-Tuple{ContGridModML.ContModel, ContGridModML.DiscModel, Real, Integer, Integer}"><code>ContGridModML.gen_idxs</code></a></li><li><a href="#ContGridModML.generate_comp_idxs-Tuple{ContGridModML.ContModel, ContGridModML.DiscModel, Vector{&lt;:Integer}, Vector{&lt;:Integer}, Int64}"><code>ContGridModML.generate_comp_idxs</code></a></li><li><a href="#ContGridModML.grad"><code>ContGridModML.grad</code></a></li><li><a href="#ContGridModML.grad_proj-Tuple{SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, Matrix{&lt;:Real}, Integer}"><code>ContGridModML.grad_proj</code></a></li><li><a href="#ContGridModML.init_expansion-Tuple{Matrix{&lt;:Real}, Integer, Integer, Vector{&lt;:Real}, Vector{&lt;:Real}}"><code>ContGridModML.init_expansion</code></a></li><li><a href="#ContGridModML.initial_conditions-Tuple{ContGridModML.ContModel}"><code>ContGridModML.initial_conditions</code></a></li><li><a href="#ContGridModML.lambda_dyn-Tuple{SciMLBase.ODESolution, SciMLBase.ODESolution, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, Real, Vector{&lt;:Integer}}"><code>ContGridModML.lambda_dyn</code></a></li><li><a href="#ContGridModML.lap_eigenvectors-Tuple{ContGridModML.ContModel}"><code>ContGridModML.lap_eigenvectors</code></a></li><li><a href="#ContGridModML.learn_dynamical_parameters-Tuple{}"><code>ContGridModML.learn_dynamical_parameters</code></a></li><li><a href="#ContGridModML.loss-Tuple{SciMLBase.ODESolution, SciMLBase.ODESolution, SparseArrays.SparseMatrixCSC, Vector{&lt;:Integer}}"><code>ContGridModML.loss</code></a></li><li><a href="#ContGridModML.projectors_dynamic-Tuple{ContGridModML.ContModel, ContGridModML.DiscModel, Vector{&lt;:Integer}}"><code>ContGridModML.projectors_dynamic</code></a></li><li><a href="#ContGridModML.simul-Union{Tuple{T}, Tuple{SciMLBase.ODESolution, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, Vector{T}, Vector{T}, Vector{T}, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, Vector{SparseArrays.SparseMatrixCSC}, Vector{&lt;:Integer}, Vector{T}, Real}} where T&lt;:Real"><code>ContGridModML.simul</code></a></li><li><a href="#ContGridModML.test_loss-Tuple{Vector{SciMLBase.ODESolution}, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, Vector{&lt;:Real}, Vector{&lt;:Real}, Matrix{&lt;:Real}, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, Vector{&lt;:Integer}, Vector{&lt;:Real}, Real}"><code>ContGridModML.test_loss</code></a></li><li><a href="#ContGridModML.trapz-Tuple{Real, Real, Real, Function, Integer}"><code>ContGridModML.trapz</code></a></li><li><a href="#ContGridModML.update-Union{Tuple{T}, Tuple{Vector{T}, Vector{T}, Matrix{T}, Integer, Function}} where T&lt;:Real"><code>ContGridModML.update</code></a></li></ul><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.assemble_f_dynamic-Tuple{ContGridModML.ContModel, ContGridModML.DiscModel, Vector{&lt;:Integer}, Union{Real, Vector{&lt;:Real}}, SparseArrays.SparseMatrixCSC}" href="#ContGridModML.assemble_f_dynamic-Tuple{ContGridModML.ContModel, ContGridModML.DiscModel, Vector{&lt;:Integer}, Union{Real, Vector{&lt;:Real}}, SparseArrays.SparseMatrixCSC}"><code>ContGridModML.assemble_f_dynamic</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">assemble_f_dynamic(
    cm::ContGridModML.ContModel,
    dm::ContGridModML.DiscModel,
    fault_ix::Vector{&lt;:Integer},
    dP::Union{Real, Vector{&lt;:Real}},
    Af::SparseArrays.SparseMatrixCSC
) -&gt; Matrix{Float64}
</code></pre><p>Assemble all the force vectors for the dynamical simulations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/7ce99ec9086564a05d206c7b5440dcd99f3b989e/src/dynamic.jl#L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.assemble_matrices_dynamic-Tuple{ContGridModML.ContModel}" href="#ContGridModML.assemble_matrices_dynamic-Tuple{ContGridModML.ContModel}"><code>ContGridModML.assemble_matrices_dynamic</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">assemble_matrices_dynamic(
    model::ContGridModML.ContModel
) -&gt; NTuple{4, SparseArrays.SparseMatrixCSC{Float64, Int64}}
</code></pre><p>Create all the necessary finite element matrices from a given model.</p><p>The matrices returned are</p><ul><li><code>M_const</code> the constant (non-parameter dependent) part of the mass matrix</li><li><code>K_const</code> the constant (non-parameter dependent) part of the stiffness matrix</li><li><code>A</code> the matrix needed to create the non-constant part of both the mass and stiffness   matrices. For example the mass matrix can be calculated as    <code>M = M_const + A * m_quad * A&#39;</code></li><li><code>Af</code> the matrix needed to create the force vector as <code>f = Af * (p_quad + fault_quad)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/7ce99ec9086564a05d206c7b5440dcd99f3b989e/src/dynamic.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.cont_dyn-Tuple{SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, Vector{&lt;:Real}, Vector{&lt;:Real}, Real}" href="#ContGridModML.cont_dyn-Tuple{SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, Vector{&lt;:Real}, Vector{&lt;:Real}, Real}"><code>ContGridModML.cont_dyn</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">cont_dyn(
    M::SparseArrays.SparseMatrixCSC,
    K::SparseArrays.SparseMatrixCSC,
    f::Vector{&lt;:Real},
    u₀::Vector{&lt;:Real},
    tf::Real;
    solve_kwargs
) -&gt; SciMLBase.ODESolution
</code></pre><p>Run a dynamical simulation of the continuous model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/7ce99ec9086564a05d206c7b5440dcd99f3b989e/src/dynamic.jl#L228">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.disc_dyn-Tuple{ContGridModML.DiscModel, Integer, Real, Real, Real}" href="#ContGridModML.disc_dyn-Tuple{ContGridModML.DiscModel, Integer, Real, Real, Real}"><code>ContGridModML.disc_dyn</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">disc_dyn(
    dm::ContGridModML.DiscModel,
    fault_node::Integer,
    fault_size::Real,
    dt::Real,
    tf::Real;
    solve_kwargs
) -&gt; SciMLBase.ODESolution
</code></pre><p>Run a dynamical simulation of the discrete model.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/7ce99ec9086564a05d206c7b5440dcd99f3b989e/src/dynamic.jl#L208">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.gen_idxs-Tuple{ContGridModML.ContModel, ContGridModML.DiscModel, Real, Integer, Integer}" href="#ContGridModML.gen_idxs-Tuple{ContGridModML.ContModel, ContGridModML.DiscModel, Real, Integer, Integer}"><code>ContGridModML.gen_idxs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gen_idxs(
    cm::ContGridModML.ContModel,
    dm::ContGridModML.DiscModel,
    dP::Real,
    n_train::Integer,
    n_test::Integer;
    seed
) -&gt; Tuple{Vector{&lt;:Integer}, Vector{&lt;:Integer}}
</code></pre><p>Randomly choose generators from a homoegenous distribution for the training and test sets.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/7ce99ec9086564a05d206c7b5440dcd99f3b989e/src/dynamic.jl#L160">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.generate_comp_idxs-Tuple{ContGridModML.ContModel, ContGridModML.DiscModel, Vector{&lt;:Integer}, Vector{&lt;:Integer}, Int64}" href="#ContGridModML.generate_comp_idxs-Tuple{ContGridModML.ContModel, ContGridModML.DiscModel, Vector{&lt;:Integer}, Vector{&lt;:Integer}, Int64}"><code>ContGridModML.generate_comp_idxs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">generate_comp_idxs(
    cm::ContGridModML.ContModel,
    dm::ContGridModML.DiscModel,
    tri::Vector{&lt;:Integer},
    tei::Vector{&lt;:Integer},
    n::Int64
) -&gt; Vector{&lt;:Integer}
</code></pre><p>Generate a list of indices used for the comparison of the ground truth with the results     from the continuous model.</p><p>An equally spaced grid is overlaid over the area. If the points are within the area, the closest bus in the discrete model is found and added to the list of indices. The generators of the test and training set are not eligible for comparison and are remove from the list of possible indices. The number of points can be controlled by <code>n</code>, which gives the number of points in the largest dimension.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/7ce99ec9086564a05d206c7b5440dcd99f3b989e/src/dynamic.jl#L120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.grad" href="#ContGridModML.grad"><code>ContGridModML.grad</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">grad(
    sol_cont::SciMLBase.ODESolution,
    sol_lambda::SciMLBase.ODESolution,
    g_proj::Vector{SparseArrays.SparseMatrixCSC}
) -&gt; Vector{Float64}
grad(
    sol_cont::SciMLBase.ODESolution,
    sol_lambda::SciMLBase.ODESolution,
    g_proj::Vector{SparseArrays.SparseMatrixCSC},
    dt::Real
) -&gt; Vector{Float64}
</code></pre><p>Calculate the gradient from the solution of the adjoint dynamics.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/7ce99ec9086564a05d206c7b5440dcd99f3b989e/src/dynamic.jl#L374">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.grad_proj-Tuple{SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, Matrix{&lt;:Real}, Integer}" href="#ContGridModML.grad_proj-Tuple{SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, Matrix{&lt;:Real}, Integer}"><code>ContGridModML.grad_proj</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">grad_proj(
    A::SparseArrays.SparseMatrixCSC,
    q_proj::SparseArrays.SparseMatrixCSC,
    evecs::Matrix{&lt;:Real},
    n_coeffs::Integer
) -&gt; Vector{SparseArrays.SparseMatrixCSC}
</code></pre><p>Calculate the projection matrix of the discrete solution onto the adjoint solution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/7ce99ec9086564a05d206c7b5440dcd99f3b989e/src/dynamic.jl#L426">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.init_expansion-Tuple{Matrix{&lt;:Real}, Integer, Integer, Vector{&lt;:Real}, Vector{&lt;:Real}}" href="#ContGridModML.init_expansion-Tuple{Matrix{&lt;:Real}, Integer, Integer, Vector{&lt;:Real}, Vector{&lt;:Real}}"><code>ContGridModML.init_expansion</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">init_expansion(
    eve::Matrix{&lt;:Real},
    n_modes::Integer,
    n_coeffs::Integer,
    m::Vector{&lt;:Real},
    d::Vector{&lt;:Real}
) -&gt; Tuple{Vector{T} where T&lt;:Real, Matrix{&lt;:Real}}
</code></pre><p>Create the initial values for the parameters.</p><p>The parameters are expanded in eigenvectors of the grid Laplacian. The first <code>n_modes</code> eigenvectors are chosen. The first <code>n_coeffs</code> coefficients are chosen by projecting the results of the heat equation diffusion onto the eigenvectors. The <code>n_modes - n_coeffs</code> are set to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/7ce99ec9086564a05d206c7b5440dcd99f3b989e/src/dynamic.jl#L317">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.initial_conditions-Tuple{ContGridModML.ContModel}" href="#ContGridModML.initial_conditions-Tuple{ContGridModML.ContModel}"><code>ContGridModML.initial_conditions</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initial_conditions(
    cm::ContGridModML.ContModel
) -&gt; Vector{T} where T&lt;:Real
</code></pre><p>Create the initial conditions for the continuous simulations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/7ce99ec9086564a05d206c7b5440dcd99f3b989e/src/dynamic.jl#L252">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.lambda_dyn-Tuple{SciMLBase.ODESolution, SciMLBase.ODESolution, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, Real, Vector{&lt;:Integer}}" href="#ContGridModML.lambda_dyn-Tuple{SciMLBase.ODESolution, SciMLBase.ODESolution, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, Real, Vector{&lt;:Integer}}"><code>ContGridModML.lambda_dyn</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">lambda_dyn(
    cont_sol::SciMLBase.ODESolution,
    disc_sol::SciMLBase.ODESolution,
    M::SparseArrays.SparseMatrixCSC,
    K::SparseArrays.SparseMatrixCSC,
    ω_proj::SparseArrays.SparseMatrixCSC,
    tf::Real,
    idxs::Vector{&lt;:Integer};
    solve_kwargs
) -&gt; SciMLBase.ODESolution
</code></pre><p>Solve the adjoint dynamics.</p><p>The continuous and discrete solutions are needed as well as the comparison indices to calculate the contributions from the loss function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/7ce99ec9086564a05d206c7b5440dcd99f3b989e/src/dynamic.jl#L262">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.lap_eigenvectors-Tuple{ContGridModML.ContModel}" href="#ContGridModML.lap_eigenvectors-Tuple{ContGridModML.ContModel}"><code>ContGridModML.lap_eigenvectors</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">lap_eigenvectors(
    cm::ContGridModML.ContModel
) -&gt; Matrix{Float64}
</code></pre><p>Calculate the eigenvectors of the unweighted Laplacian of the grid used for the continuous     simulations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/7ce99ec9086564a05d206c7b5440dcd99f3b989e/src/dynamic.jl#L295">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.learn_dynamical_parameters-Tuple{}" href="#ContGridModML.learn_dynamical_parameters-Tuple{}"><code>ContGridModML.learn_dynamical_parameters</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">learn_dynamical_parameters(
;
    dm_fn,
    cm_fn,
    dP,
    n_train,
    n_test,
    dt,
    tf,
    disc_solve_kwargs,
    cont_solve_kwargs,
    lambda_solve_kwargs,
    seed,
    n_points,
    m_init,
    d_init,
    n_coeffs,
    n_modes,
    n_epochs,
    max_function,
    train_ix,
    test_ix
) -&gt; ContGridModML.DynamicSol
</code></pre><p>Learn the inertia and damping distribution for the continuous model.</p><p>The frequency response of faults at multiple generators are compared on homogeneously spread buses across the grid. The gradient is calculated using an adjoint sensitivity method and the updates to the parameters are calculated using a constraint gradient descent method.</p><p><strong>Arguments</strong></p><ul><li><code>dm_fn::String = MODULE_FOLDER * &quot;/data/dm.h5&quot;</code>: File name of the discrete model</li><li><code>cm_fn::String = MODULE_FOLDER * &quot;/data/cm.h5&quot;</code>: File name of the continuous model</li><li><code>dP::Real = -9.0</code>: Fault size to be simulated</li><li><code>n_train::Integer = 12</code>: Amount of faults to consider for training</li><li><code>n_test::Integer = 4</code>: Amount of faults to consider for testing</li><li><code>dt::Real = 0.01</code>: Step size at which the solutions of the ODEs are saved</li><li><code>tf::Real = 25.0</code>: Duration of the simulations</li><li><code>disc_solve_kwargs::Dict{Symbol, &lt;:Any} = Dict{Symbol, Any}()</code>: Keyword arguments passed  to the ODE solver for the discrete model</li><li><code>cont_solve_kwargs::Dict{Symbol, &lt;:Any} = Dict{Symbol, Any}()</code>: Keyword arguments passed  to the ODE solver for the continuous model</li><li><code>lambda_solve_kwargs::Dict{Symbol, &lt;:Any} = Dict{Symbol, Any}(:saveat =&gt; 0.1,  :abstol =&gt; 1e-3, :reltol =&gt; 1e-2)</code>: Keyword arguments passed to the ODE solver of the  adjoint equations</li><li><code>seed::Union{Nothing, Integer} = 1709</code>: Seed for the random number generator to be used   to pick the training and test generators</li><li><code>σ = 0.05</code>: Standard deviation of the Gaussian used to distribute the fault</li><li><code>n_points = 40</code>: Number of points for comparison along the largest dimension</li><li><code>n_coeffs = 1</code>: Number of coefficients that are non-zero at the beginning of the  training. They correspond to the <code>n_coeffs</code> lowest modes of the Laplacian.</li><li><code>n_modes = 20</code>: Number of modes the Laplacian that are used to expand the parameters.</li><li><code>n_epochs = 8000</code>: Number of epochs used for the training.</li><li><code>max_function::Function = (x) -&gt; 30 * 2^(x / 500)</code>: Function that changes the magnitude  of the change vector of the parameters wrt the epoch.</li><li><code>train_ix::Union{Nothing, Vector{&lt;:Integer}} = nothing</code>: Indices of the generators used  for training if they are not supposed to be picked randomly.</li><li><code>test_ix::Union{Nothing, Vector{&lt;:Integer}} = nothing</code>: Indices of the generators used  for testing if they are not supposed to be picked randomly.</li></ul><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>If the training and test generators are not supposed to be picked randomly, both <code>train_ix</code> and <code>test_ix</code> need to be passed.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/7ce99ec9086564a05d206c7b5440dcd99f3b989e/src/dynamic.jl#L465">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.loss-Tuple{SciMLBase.ODESolution, SciMLBase.ODESolution, SparseArrays.SparseMatrixCSC, Vector{&lt;:Integer}}" href="#ContGridModML.loss-Tuple{SciMLBase.ODESolution, SciMLBase.ODESolution, SparseArrays.SparseMatrixCSC, Vector{&lt;:Integer}}"><code>ContGridModML.loss</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">loss(
    sol_cont::SciMLBase.ODESolution,
    sol_disc::SciMLBase.ODESolution,
    ω_proj::SparseArrays.SparseMatrixCSC,
    idxs::Vector{&lt;:Integer}
) -&gt; Vector{Float64}
</code></pre><p>Calculate the value of the loss function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/7ce99ec9086564a05d206c7b5440dcd99f3b989e/src/dynamic.jl#L410">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.projectors_dynamic-Tuple{ContGridModML.ContModel, ContGridModML.DiscModel, Vector{&lt;:Integer}}" href="#ContGridModML.projectors_dynamic-Tuple{ContGridModML.ContModel, ContGridModML.DiscModel, Vector{&lt;:Integer}}"><code>ContGridModML.projectors_dynamic</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">projectors_dynamic(
    cm::ContGridModML.ContModel,
    dm::ContGridModML.DiscModel,
    ω_idxs::Vector{&lt;:Integer}
) -&gt; SparseArrays.SparseMatrixCSC{Float64, Int64}
</code></pre><p>Create projectors for nodal values onto quadrature points and onto comparison locations.</p><p>Returned projectors</p><ul><li><code>ω_proj</code> Project the nodal values onto the given comparison points. This is used to   calculate the loss function.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/7ce99ec9086564a05d206c7b5440dcd99f3b989e/src/dynamic.jl#L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.simul-Union{Tuple{T}, Tuple{SciMLBase.ODESolution, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, Vector{T}, Vector{T}, Vector{T}, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, Vector{SparseArrays.SparseMatrixCSC}, Vector{&lt;:Integer}, Vector{T}, Real}} where T&lt;:Real" href="#ContGridModML.simul-Union{Tuple{T}, Tuple{SciMLBase.ODESolution, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, Vector{T}, Vector{T}, Vector{T}, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, Vector{SparseArrays.SparseMatrixCSC}, Vector{&lt;:Integer}, Vector{T}, Real}} where T&lt;:Real"><code>ContGridModML.simul</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">simul(
    disc_sol::SciMLBase.ODESolution,
    M_const::SparseArrays.SparseMatrixCSC,
    K_const::SparseArrays.SparseMatrixCSC,
    m::Array{T&lt;:Real, 1},
    d::Array{T&lt;:Real, 1},
    f::Array{T&lt;:Real, 1},
    A::SparseArrays.SparseMatrixCSC,
    q_proj::SparseArrays.SparseMatrixCSC,
    ω_proj::SparseArrays.SparseMatrixCSC,
    g_proj::Vector{SparseArrays.SparseMatrixCSC},
    idxs::Vector{&lt;:Integer},
    u₀::Array{T&lt;:Real, 1},
    tf::Real;
    cont_kwargs,
    lambda_kwargs
) -&gt; Tuple{Vector{T} where T&lt;:Real, Real}
</code></pre><p>Do a full simulation step for one data set.</p><p>The continuous solution is calculated first and then used to obtain the adjoint solution. Afterwards, the gradient and value of the loss function are calculated and returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/7ce99ec9086564a05d206c7b5440dcd99f3b989e/src/dynamic.jl#L341">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.test_loss-Tuple{Vector{SciMLBase.ODESolution}, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, Vector{&lt;:Real}, Vector{&lt;:Real}, Matrix{&lt;:Real}, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, Vector{&lt;:Integer}, Vector{&lt;:Real}, Real}" href="#ContGridModML.test_loss-Tuple{Vector{SciMLBase.ODESolution}, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, Vector{&lt;:Real}, Vector{&lt;:Real}, Matrix{&lt;:Real}, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, SparseArrays.SparseMatrixCSC, Vector{&lt;:Integer}, Vector{&lt;:Real}, Real}"><code>ContGridModML.test_loss</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">test_loss(
    disc_sols::Vector{SciMLBase.ODESolution},
    M_const::SparseArrays.SparseMatrixCSC,
    K_const::SparseArrays.SparseMatrixCSC,
    m::Vector{&lt;:Real},
    d::Vector{&lt;:Real},
    f_test::Matrix{&lt;:Real},
    A::SparseArrays.SparseMatrixCSC,
    q_proj::SparseArrays.SparseMatrixCSC,
    ω_proj::SparseArrays.SparseMatrixCSC,
    idxs::Vector{&lt;:Integer},
    u₀::Vector{&lt;:Real},
    tf::Real;
    cont_kwargs
) -&gt; Vector{Float64}
</code></pre><p>Calculate the loss values for the test data sets.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/7ce99ec9086564a05d206c7b5440dcd99f3b989e/src/dynamic.jl#L592">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.trapz-Tuple{Real, Real, Real, Function, Integer}" href="#ContGridModML.trapz-Tuple{Real, Real, Real, Function, Integer}"><code>ContGridModML.trapz</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">trapz(
    t₀::Real,
    tf::Real,
    dt::Real,
    int!::Function,
    N::Integer
) -&gt; Vector{Float64}
</code></pre><p>Trapezoidal rule for the integration of a given function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/7ce99ec9086564a05d206c7b5440dcd99f3b989e/src/dynamic.jl#L393">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.update-Union{Tuple{T}, Tuple{Vector{T}, Vector{T}, Matrix{T}, Integer, Function}} where T&lt;:Real" href="#ContGridModML.update-Union{Tuple{T}, Tuple{Vector{T}, Vector{T}, Matrix{T}, Integer, Function}} where T&lt;:Real"><code>ContGridModML.update</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">update(
    p::Array{T&lt;:Real, 1},
    g::Array{T&lt;:Real, 1},
    eve::Array{T&lt;:Real, 2},
    i::Integer,
    f::Function
) -&gt; Vector{T} where T&lt;:Real
</code></pre><p>Update the parameters using a restricted gradient descent to ensure positiveness.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/7ce99ec9086564a05d206c7b5440dcd99f3b989e/src/dynamic.jl#L442">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../public/">« Public</a><a class="docs-footer-nextpage" href="../static/">Static.jl »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Wednesday 24 January 2024 10:56">Wednesday 24 January 2024</span>. Using Julia version 1.10.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
