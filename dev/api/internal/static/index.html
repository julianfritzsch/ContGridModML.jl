<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Static.jl · ContGridModML</title><meta name="title" content="Static.jl · ContGridModML"/><meta property="og:title" content="Static.jl · ContGridModML"/><meta property="twitter:title" content="Static.jl · ContGridModML"/><meta name="description" content="Documentation for ContGridModML."/><meta property="og:description" content="Documentation for ContGridModML."/><meta property="twitter:description" content="Documentation for ContGridModML."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">ContGridModML</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Introduction</a></li><li><span class="tocitem">Implementation</span><ul><li><a class="tocitem" href="../../../implementation/finite/">Finite Element Method</a></li><li><a class="tocitem" href="../../../implementation/general/">General Implementation</a></li><li><a class="tocitem" href="../../../implementation/static/">Learn Susceptances</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../public/">Public</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox" checked/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Internal</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../dynamic/">Dynamic.jl</a></li><li class="is-active"><a class="tocitem" href>Static.jl</a><ul class="internal"><li><a class="tocitem" href="#Contents"><span>Contents</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#Functions"><span>Functions</span></a></li></ul></li><li><a class="tocitem" href="../tools/">Tools.jl</a></li><li><a class="tocitem" href="../mesh/">Mesh.jl</a></li><li><a class="tocitem" href="../init/">Initl.jl</a></li><li><a class="tocitem" href="../disc_dynamics/">Disc_dynamics.jl</a></li><li><a class="tocitem" href="../cont_dynamics/">Cont_dynamics.jl</a></li><li><a class="tocitem" href="../plot/">Plot.jl</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li><a class="is-disabled">Internal</a></li><li class="is-active"><a href>Static.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Static.jl</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/julianfritzsch/ContGridModML.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/main/docs/src/api/internal/static.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Static.jl"><a class="docs-heading-anchor" href="#Static.jl">Static.jl</a><a id="Static.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Static.jl" title="Permalink"></a></h1><p>Description of internally used functions for the learning of the static parameters.</p><h2 id="Contents"><a class="docs-heading-anchor" href="#Contents">Contents</a><a id="Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Contents" title="Permalink"></a></h2><ul><li><a href="#Contents">Contents</a></li><li><a href="#Index">Index</a></li><li><a href="#Functions">Functions</a></li></ul><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#ContGridModML._learn_susceptances-Union{Tuple{T}, Tuple{SparseArrays.AbstractSparseMatrix, SparseArrays.AbstractSparseMatrix, SparseArrays.AbstractSparseMatrix, SparseArrays.AbstractSparseMatrix, Matrix{T}, Matrix{T}, Vector{T}, Matrix{T}, Vector{Int64}, Integer, Int64}} where T&lt;:Real"><code>ContGridModML._learn_susceptances</code></a></li><li><a href="#ContGridModML.assemble_disc_theta-Tuple{Vector{ContGridModML.DiscModel}}"><code>ContGridModML.assemble_disc_theta</code></a></li><li><a href="#ContGridModML.assemble_f_static-Tuple{ContGridModML.ContModel, Vector{ContGridModML.DiscModel}, SparseArrays.SparseMatrixCSC}"><code>ContGridModML.assemble_f_static</code></a></li><li><a href="#ContGridModML.assemble_matrices_static-Tuple{ContGridModML.ContModel}"><code>ContGridModML.assemble_matrices_static</code></a></li><li><a href="#ContGridModML.check_slack-Tuple{Vector{ContGridModML.DiscModel}}"><code>ContGridModML.check_slack</code></a></li><li><a href="#ContGridModML.discrete_models-Tuple{String, String, Real}"><code>ContGridModML.discrete_models</code></a></li><li><a href="#ContGridModML.get_losses-Tuple{Matrix{&lt;:Real}, Matrix{&lt;:Real}, Matrix{&lt;:Real}, Matrix{&lt;:Real}}"><code>ContGridModML.get_losses</code></a></li><li><a href="#ContGridModML.learn_susceptances-Tuple{}"><code>ContGridModML.learn_susceptances</code></a></li><li><a href="#ContGridModML.prediction-Union{Tuple{T}, Tuple{SparseArrays.AbstractSparseMatrix, Matrix{T}, Matrix{T}, SparseArrays.AbstractSparseMatrix}} where T&lt;:Real"><code>ContGridModML.prediction</code></a></li><li><a href="#ContGridModML.projectors_static-Tuple{ContGridModML.ContModel, ContGridModML.DiscModel}"><code>ContGridModML.projectors_static</code></a></li></ul><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML._learn_susceptances-Union{Tuple{T}, Tuple{SparseArrays.AbstractSparseMatrix, SparseArrays.AbstractSparseMatrix, SparseArrays.AbstractSparseMatrix, SparseArrays.AbstractSparseMatrix, Matrix{T}, Matrix{T}, Vector{T}, Matrix{T}, Vector{Int64}, Integer, Int64}} where T&lt;:Real" href="#ContGridModML._learn_susceptances-Union{Tuple{T}, Tuple{SparseArrays.AbstractSparseMatrix, SparseArrays.AbstractSparseMatrix, SparseArrays.AbstractSparseMatrix, SparseArrays.AbstractSparseMatrix, Matrix{T}, Matrix{T}, Vector{T}, Matrix{T}, Vector{Int64}, Integer, Int64}} where T&lt;:Real"><code>ContGridModML._learn_susceptances</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_learn_susceptances(
    A::SparseArrays.AbstractSparseMatrix,
    Islack::SparseArrays.AbstractSparseMatrix,
    q_proj::SparseArrays.AbstractSparseMatrix,
    disc_proj::SparseArrays.AbstractSparseMatrix,
    f_train::Array{T&lt;:Real, 2},
    th_train::Array{T&lt;:Real, 2},
    p::Array{T&lt;:Real, 1},
    eve::Array{T&lt;:Real, 2},
    comp_ix::Vector{Int64},
    n_epoch::Integer,
    n_batch::Int64;
    opt,
    bmin,
    rng,
    δ
) -&gt; Tuple{Any, Matrix{T} where T&lt;:Real}
</code></pre><p>Do the actual learning of the parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/1844ed561a8df2b6d67cf2ca97415af6c8ac4102/src/static.jl#L205">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.assemble_disc_theta-Tuple{Vector{ContGridModML.DiscModel}}" href="#ContGridModML.assemble_disc_theta-Tuple{Vector{ContGridModML.DiscModel}}"><code>ContGridModML.assemble_disc_theta</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">assemble_disc_theta(
    dataset::Vector{ContGridModML.DiscModel}
) -&gt; Matrix{&lt;:Real}
</code></pre><p>Assemble all the ground truth data into one matrix for the training and one for the test sets.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/1844ed561a8df2b6d67cf2ca97415af6c8ac4102/src/static.jl#L78">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.assemble_f_static-Tuple{ContGridModML.ContModel, Vector{ContGridModML.DiscModel}, SparseArrays.SparseMatrixCSC}" href="#ContGridModML.assemble_f_static-Tuple{ContGridModML.ContModel, Vector{ContGridModML.DiscModel}, SparseArrays.SparseMatrixCSC}"><code>ContGridModML.assemble_f_static</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">assemble_f_static(
    model::ContGridModML.ContModel,
    dataset::Vector{ContGridModML.DiscModel},
    Af::SparseArrays.SparseMatrixCSC
) -&gt; Matrix{Float64}
</code></pre><p>Assemble the force vectors for the static solutions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/1844ed561a8df2b6d67cf2ca97415af6c8ac4102/src/static.jl#L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.assemble_matrices_static-Tuple{ContGridModML.ContModel}" href="#ContGridModML.assemble_matrices_static-Tuple{ContGridModML.ContModel}"><code>ContGridModML.assemble_matrices_static</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">assemble_matrices_static(
    model::ContGridModML.ContModel
) -&gt; Tuple{SparseArrays.SparseMatrixCSC{Float64, Int64}, SparseArrays.SparseMatrixCSC{Float64, Int64}, SparseArrays.SparseMatrixCSC{Float64, Int64}}
</code></pre><p>Create all the necessary finite element matrices from a given model.</p><p>The returned matrices are</p><ul><li><code>Af</code> the matrix needed to create the force vector as <code>f = Af * p_quad</code></li><li><code>Ak</code> the matrix needed to create the stiffness matrix as <code>K = A * b_quad * A&#39;</code>. The   susceptances need to be ordered as   <span>$b_x(\mathbf{q_1}), b_y(\mathbf{q_1}), b_x(\mathbf{q_2}),\dots$</span></li><li><code>dim</code> matrix with single entry for the slack bus to ensure well-posedness of the system   of linear equations</li><li><code>q_coords</code> Coordinates of the quadrature points in the same order as stored in   the DoF-handler</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/1844ed561a8df2b6d67cf2ca97415af6c8ac4102/src/static.jl#L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.check_slack-Tuple{Vector{ContGridModML.DiscModel}}" href="#ContGridModML.check_slack-Tuple{Vector{ContGridModML.DiscModel}}"><code>ContGridModML.check_slack</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">check_slack(
    dataset::Vector{ContGridModML.DiscModel}
) -&gt; Bool
</code></pre><p>Check if all the slack buses in the training and test data sets are the same.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/1844ed561a8df2b6d67cf2ca97415af6c8ac4102/src/static.jl#L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.discrete_models-Tuple{String, String, Real}" href="#ContGridModML.discrete_models-Tuple{String, String, Real}"><code>ContGridModML.discrete_models</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">discrete_models(
    train_folder::String,
    test_folder::String,
    scale_factor::Real
) -&gt; Tuple{Vector{ContGridModML.DiscModel}, Vector{ContGridModML.DiscModel}}
</code></pre><p>Load all the discrete models for the training and test data sets.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/1844ed561a8df2b6d67cf2ca97415af6c8ac4102/src/static.jl#L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.get_losses-Tuple{Matrix{&lt;:Real}, Matrix{&lt;:Real}, Matrix{&lt;:Real}, Matrix{&lt;:Real}}" href="#ContGridModML.get_losses-Tuple{Matrix{&lt;:Real}, Matrix{&lt;:Real}, Matrix{&lt;:Real}, Matrix{&lt;:Real}}"><code>ContGridModML.get_losses</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_losses(
    train_pred::Matrix{&lt;:Real},
    test_pred::Matrix{&lt;:Real},
    t_train::Matrix{&lt;:Real},
    t_test::Matrix{&lt;:Real};
    δ
) -&gt; Tuple{Vector{T} where T&lt;:Real, Vector{T} where T&lt;:Real}
</code></pre><p>Obtain the loss values for the training and test data sets.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/1844ed561a8df2b6d67cf2ca97415af6c8ac4102/src/static.jl#L427">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.learn_susceptances-Tuple{}" href="#ContGridModML.learn_susceptances-Tuple{}"><code>ContGridModML.learn_susceptances</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">learn_susceptances(
;
    train_folder,
    test_folder,
    mesh_fn,
    n_epoch,
    n_batch,
    n_modes,
    n_coeffs,
    comp_ix,
    bx_init,
    by_init,
    rng,
    opt,
    bmin,
    δ
) -&gt; ContGridModML.StaticSol{Float64}
</code></pre><p>Learn the line susceptances.</p><p>The parameters are learned by calculating the stable solution for multiple dispatches and comparing them to the results from the discrete model. The comparison points are obtained by using the liear approximation provided by the finite element method.</p><p><strong>Arguments</strong></p><ul><li><code>train_fn::String = MODULE_FOLDER * &quot;/data/ml/training_</code>&quot;: The names of the files   containing the training scenarios. The files must be labeled <code>train_fn1.h5</code>,   <code>train_fn2.h5</code>, etc.</li><li><code>test_fn::String = MODULE_FOLDER * &quot;/data/ml/test_&quot;</code>: The names of the files   containing the test scenarios. The files must be labeled <code>test.h5</code>, <code>test.h5</code>, etc.</li><li><code>grid_fn::String = MODULE_FOLDER * &quot;/data/panta.msh&quot;</code>: Name of the file containing the mesh</li><li><code>n_train::Int = 48</code>: Number of training data sets</li><li><code>n_test::Int = 12</code>: Number of test data sets</li><li><code>n_epochs::Int = 10000</code>: Number of epochs</li><li><code>n_batches::Int = 3</code>: Number of batches per epoch</li><li><code>tf::Real = 0.05</code>: Duration of the heat equation diffusion for the power distribution </li><li><code>κ::Real = 0.02</code>: Diffusion constant of the heat equation diffusion for the power   distribution</li><li><code>σ::Real = 0.01</code>: Standard deviation for the initial Gaussian distribution of the   parameters</li><li><code>rng::AbstractRNG = Xoshiro()</code>: Random number generator used to draw all random numbers</li><li><code>bmin::Real = 0.1</code>: Minimimum value of the suscpetances</li><li><code>δ = 0.5</code>: Parameter of the Huber loss function</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/1844ed561a8df2b6d67cf2ca97415af6c8ac4102/src/static.jl#L253">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.prediction-Union{Tuple{T}, Tuple{SparseArrays.AbstractSparseMatrix, Matrix{T}, Matrix{T}, SparseArrays.AbstractSparseMatrix}} where T&lt;:Real" href="#ContGridModML.prediction-Union{Tuple{T}, Tuple{SparseArrays.AbstractSparseMatrix, Matrix{T}, Matrix{T}, SparseArrays.AbstractSparseMatrix}} where T&lt;:Real"><code>ContGridModML.prediction</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">prediction(
    K::SparseArrays.AbstractSparseMatrix,
    f_train::Array{T&lt;:Real, 2},
    f_test::Array{T&lt;:Real, 2},
    proj::SparseArrays.AbstractSparseMatrix
) -&gt; Tuple{Any, Any}
</code></pre><p>Obtain the prediction of the stable solution for the training and test data sets.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/1844ed561a8df2b6d67cf2ca97415af6c8ac4102/src/static.jl#L415">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ContGridModML.projectors_static-Tuple{ContGridModML.ContModel, ContGridModML.DiscModel}" href="#ContGridModML.projectors_static-Tuple{ContGridModML.ContModel, ContGridModML.DiscModel}"><code>ContGridModML.projectors_static</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">projectors_static(
    model::ContGridModML.ContModel,
    dm::ContGridModML.DiscModel
) -&gt; Tuple{SparseArrays.SparseMatrixCSC{Float64, Int64}, SparseArrays.SparseMatrixCSC{Float64, Int64}}
</code></pre><p>Projectors of nodal values onto the discrete values and the quadrature points.</p><p>The returned matrices are</p><ul><li><code>θ_proj</code> project the nodal values onto the discrete nodes for comparison</li><li><code>q_proj_b</code> project the susceptances onto the quadrature points. The susceptances need to    be ordered as <span>$b_x(\mathbf{r_1}), b_y(\mathbf{r_1}), b_x(\mathbf{r_2}),\dots$</span></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/julianfritzsch/ContGridModML.jl/blob/1844ed561a8df2b6d67cf2ca97415af6c8ac4102/src/static.jl#L140">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../dynamic/">« Dynamic.jl</a><a class="docs-footer-nextpage" href="../tools/">Tools.jl »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.3.0 on <span class="colophon-date" title="Tuesday 2 April 2024 06:25">Tuesday 2 April 2024</span>. Using Julia version 1.10.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
